# מערכת בדיקת תלויות (Dependency Checker)

## סקירה כללית

מערכת בדיקת התלויות של WordPress AI Assistant מספקת דרך אוטומטית וידידותית לוודא שכל הרכיבים הנדרשים מותקנים ופעילים. המערכת בודקת PHP extensions, ספריות חיצוניות, ותלויות אחרות הנדרשות לפעולה תקינה של התוסף.

## תכונות עיקריות

### 🔍 בדיקה אוטומטית
- בדיקה אוטומטית בעת טעינת עמודי הניהול של התוסף
- זיהוי מיידי של רכיבים חסרים
- הפרדה ברורה בין תלויות נדרשות, מומלצות ואופציונליות

### 📊 עמוד System Status
- תצוגה מפורטת של כל התלויות
- אינדיקטורים ויזואליים ברורים (✅/❌)
- פרטי סביבת השרת (WordPress, PHP, זיכרון)
- טבלאות מסודרות לפי סוג תלות

### ⚠️ התראות חכמות
- התראות בממשק הניהול רק בעמודים רלוונטיים
- הודעות מותאמות לפי רמת חומרה (Error/Warning)
- אפשרות להתעלם מהתראות על רכיבים מומלצים
- לינקים ישירים להוראות התקנה

### 🔗 הנחיות התקנה
- לינק ישיר לתיעוד הרשמי של כל רכיב
- הסברים ברורים על תפקיד כל תלות
- המלצות מעשיות להתקנה

## סוגי תלויות

### Required (נדרש)
רכיבים שחובה להתקין כדי שהתוסף יפעל:
- **PHP cURL** - נדרש לתקשורת עם API של ספקי AI
- **PHP JSON** - נדרש לעיבוד נתונים מ-API

אם חסרות תלויות נדרשות:
- תוצג התראה אדומה בכל עמודי הניהול
- לא ניתן להתעלם מההתראה
- יש לפנות למנהל השרת להתקנה

### Recommended (מומלץ)
רכיבים שישפרו משמעותית את הביצועים והיכולות:
- **WordPress Feature API** - מאפשר ניהול מתקדם של features

אם חסרות תלויות מומלצות:
- תוצג התראה כתומה (warning)
- ניתן להתעלם מההתראה
- התקנה תשפר חוויה אך לא חיונית

### Optional (אופציונלי)
רכיבים נוספים שיכולים לשפר חוויה ספציפית.

## איך להשתמש

### גישה לעמוד System Status

1. היכנס לממשק הניהול של WordPress
2. לחץ על **AI Assistant** בתפריט הצד
3. בחר **System Status** מתפריט המשנה

### פרשנות המידע

#### אינדיקטורים ויזואליים
- ✅ **ירוק** - הרכיב מותקן ופעיל
- ❌ **אדום** - הרכיב חסר וצריך התקנה

#### טבלת תלויות
כל שורה מכילה:
- **שם** - שם הרכיב
- **סוג** - extension/library/plugin
- **סטטוס** - מותקן/חסר
- **תיאור** - מה הרכיב עושה ולמה הוא נדרש
- **פעולות** - כפתור להוראות התקנה (אם חסר)

### איך להתקין רכיב חסר

#### PHP Extensions (cURL, JSON)
1. לחץ על "הוראות התקנה" ליד הרכיב
2. העבר את המידע למנהל השרת שלך
3. מנהל השרת צריך להתקין דרך:
   ```bash
   # לדוגמה ב-Ubuntu/Debian:
   sudo apt-get install php-curl php-json
   sudo systemctl restart apache2
   ```

#### ספריות חיצוניות (Libraries)
1. לחץ על "הוראות התקנה" ליד הספרייה
2. עקוב אחר ההנחיות בתיעוד הרשמי
3. רוב הספריות ניתן להתקין דרך Composer:
   ```bash
   composer require vendor/package-name
   ```

## ארכיטקטורה טכנית

### מבנה הקוד

```
includes/
└── class-dependency-checker.php    # המחלקה המרכזית
    ├── define_dependencies()       # הגדרת תלויות
    ├── check_all_dependencies()    # בדיקת כל התלויות
    ├── display_dependency_notices()# הצגת התראות
    └── get_dependencies_status()   # מידע מפורט

admin/
└── class-admin.php                 # ממשק ניהול
    ├── add_admin_menu()           # הוספת עמוד System Status
    └── display_system_status_page()# תצוגת העמוד
```

### הוספת בדיקה חדשה

כדי להוסיף בדיקת תלות חדשה, ערוך את `class-dependency-checker.php`:

```php
// בתוך define_dependencies()
$this->dependencies['my_dependency'] = array(
    'name' => 'שם הרכיב',
    'type' => 'library',  // או extension/plugin
    'status' => 'recommended',  // או required/optional
    'description' => __('תיאור הרכיב ותפקידו', 'wordpress-ai-assistant'),
    'check_method' => array($this, 'check_my_dependency'),
    'install_method' => 'composer',  // או manual/system/plugin
    'docs_url' => 'https://link-to-docs.com',
);

// הוסף פונקציית בדיקה
private function check_my_dependency() {
    // החזר true אם קיים, false אם חסר
    return class_exists('My_Dependency_Class');
}
```

## אבטחה

### בדיקות הרשאות
- כל הפעולות דורשות `manage_options` capability
- AJAX handlers מאומתים עם nonce
- Sanitization מלא של קלט משתמש

### הצפנה
- מידע רגיש לא נשמר במערכת
- API keys מוצפנים בנפרד (מחוץ למערכת הזו)

## שאלות נפוצות

### מה קורה אם תלות נדרשת חסרה?
התוסף ימשיך לפעול במצב מוגבל. חלק מהיכולות לא יהיו זמינות עד להתקנת התלות.

### איך אני יכול להתעלם מהתראה על תלות מומלצת?
לחץ על ה-X בפינה השמאלית של ההתראה. ההתראה לא תוצג יותר.

### איך אני יכול להציג שוב התראה שהתעלמתי ממנה?
נקה את meta data של המשתמש:
```php
delete_user_meta(get_current_user_id(), 'at_ai_dismissed_recommended_deps');
```

### האם הבדיקה משפיעה על ביצועים?
לא. הבדיקה מתבצעת רק בעמודי ניהול רלוונטיים ורק פעם אחת לטעינה.

## שיפורים עתידיים

- [ ] התקנה אוטומטית של תוספי WordPress
- [ ] בדיקת גרסאות מינימליות של תלויות
- [ ] אינטגרציה עם Composer להתקנה אוטומטית
- [ ] בדיקות נוספות (MB String, GD, וכו')
- [ ] התראות במייל למנהל על תלויות חסרות
- [ ] רישום אירועים (logging) של בדיקות

## תרומה לפרויקט

רוצה להוסיף בדיקה חדשה או לשפר את המערכת?
1. פתח issue ב-GitHub
2. צור Pull Request עם השינויים
3. ודא שהקוד עוקב אחר תקני WordPress

## רישיון

מערכת זו היא חלק מתוסף WordPress AI Assistant וכפופה לאותו רישיון GPL v2.

---

**גרסה:** 1.2.1  
**תאריך עדכון:** 21 בינואר 2025  
**מפתח:** Amit Trabelsi  
**אתר:** https://amit-trabelsi.co.il

